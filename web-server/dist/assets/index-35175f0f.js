(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const g=new WebSocket("ws://"+window.location.hostname+":81/");g.onmessage=e=>{evtObj=json.parse(e.data),console.log(evtObj),E(evtObj)};const l=16,y=document.documentElement,a=document.getElementById("grid"),L=document.getElementById("controls");let d="";(()=>{for(let e=0;e<l*l;e++){const t=document.createElement("div");t.classList.add("grid-cell"),t.id=`cell-${e}`,a.appendChild(t),t.addEventListener("mousedown",()=>p(t)),t.addEventListener("mouseover",o=>{o.buttons===1&&p(t)})}})();const p=e=>{const t=parseInt(e.id.match(/\d+/)[0]),o=t%l,n=Math.floor(t/l);let r;switch(d){case"ERASER":e.style.backgroundColor="";default:e.style.backgroundColor=d}if(d=="ERASER"&&(r=[[o,n],[0,0,0]]),e.style.backgroundColor){let u=e.style.backgroundColor.slice(4,-1).split(", ").map(Number);var s=u[0],c=u[1],i=u[2];r=[[o,n],[s,c,i]]}g.send(JSON.stringify(r)),console.log(JSON.stringify(r))},b=e=>{const t=document.elementFromPoint(e.clientX,e.clientY);t.classList.contains("grid-cell")&&p(t)};a.addEventListener("touchstart",e=>{isDrawing=!0,b(e.touches[0])});a.addEventListener("touchmove",e=>{e.touches.length>=2||(e.preventDefault(),isDrawing&&b(e.touches[0]))});a.addEventListener("touchend",()=>{isDrawing=!1});const m={0:"#ffffff",1:"#232035",2:"#44293c",3:"#ff0000",4:"#df7027",5:"#d8a067",6:"#efc39b",7:"#fbf337",8:"#98e450",9:"#6abf31",10:"#37946e",11:"#4b682e",12:"#524b24",13:"#323c39",14:"#3e3f75",15:"#316083",16:"#5a6ee0",17:"#639afe",18:"#5ecde5",19:"#cadafc",20:"#dddddd",21:"#9badb7",22:"#857f87",23:"#686a6b"};(()=>{for(let e=0;e<24;e++){const t=document.createElement("div");t.classList.add("color-cell"),t.id=`color-${e}`,t.style.backgroundColor=m[e],t.addEventListener("mousedown",()=>{d=`${m[e]}`,y.style.setProperty("--selected-color",`${m[e]}`)}),L.appendChild(t)}})();const O=document.getElementById("eraser"),w=document.getElementById("clear"),C=document.getElementById("color-picker"),v=()=>{a.childNodes.forEach(t=>{t.style.backgroundColor=""});const e=JSON.stringify("LIMPIAR");g.send(e),console.log(e)};O.addEventListener("mousedown",()=>{d="ERASER",y.style.setProperty("--selected-color","#000000")});w.addEventListener("mousedown",v);C.addEventListener("input",e=>{d=e.target.value,y.style.setProperty("--selected-color",d)});const N=()=>{const e=[];let t,o,n=0;for(t=0;t<l;t++)for(o=0;o<l;o++){let i=a.childNodes[n].style.backgroundColor;if(i&&i!="rgb(0, 0, 0)"){let f=i.slice(4,-1).split(", ").map(Number);var r=f[0],s=f[1],c=f[2];const u=[[t,o],[r,s,c]];e.push(u)}n++}return JSON.stringify(e)},S=()=>{const e=N(),t=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download="gridData.json",n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)},D=document.getElementById("save-btn");D.addEventListener("click",S);const E=e=>{const t=JSON.parse(e);console.log(t),v(),t.forEach(o=>{let n=o[0][0]*l+o[0][1];a.childNodes[n].style.backgroundColor=`rgb(${o[1][0]}, ${o[1][1]}, ${o[1][2]})`})},I=e=>{const t=new FileReader;t.onload=o=>{const n=o.target.result;E(n),g.send(n)},t.readAsText(e)},R=document.getElementById("load-input");R.addEventListener("change",e=>{const t=e.target.files[0];t&&I(t)});
